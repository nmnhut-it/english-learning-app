<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Unit 11: Making a Film - The Passive Voice | English Grammar Games</title>
  <meta name="description" content="Practice the passive voice (present simple) with by and with">

  <!-- Shared Styles -->
  <link rel="stylesheet" href="../css/shared.css">
</head>
<body>
  <!-- Game Header -->
  <header class="game-header">
    <div class="container">
      <div class="game-header__container">
        <div class="game-header__info-section">
          <h1 class="game-header__title">Unit 11: Making a Film</h1>
          <p class="game-header__subtitle">The Passive Voice</p>
          <div class="game-info">
            <div class="game-info__item">
              <span class="game-info__label">GiÃ¡o viÃªn:</span>
              <span class="game-info__value">Nguyá»…n Minh Nhá»±t</span>
            </div>
            <div class="game-info__item">
              <span class="game-info__label">Há»c sinh:</span>
              <span class="game-info__value"></span>
            </div>
          </div>
        </div>

        <div class="game-header__stats">
          <div class="stat">
            <span class="stat__label">Äiá»ƒm</span>
            <span class="stat__value stat__value--primary" id="current-score">â­ 0</span>
          </div>

          <div class="stat">
            <span class="stat__label">Tiáº¿n Ä‘á»™</span>
            <span class="stat__value" id="progress-count">0 / 0</span>
          </div>

          <div class="stat" id="combo-display" style="display: none;">
            <span class="stat__label">Combo</span>
            <span class="stat__value" id="combo-count">0</span>
          </div>
        </div>
      </div>

      <!-- Progress Bar -->
      <div class="progress">
        <div class="progress__bar" id="progress-bar" style="width: 0%;"></div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="container">
    <!-- Theory Panel (Collapsible) -->
    <div class="theory-panel" id="theory-panel">
      <button class="theory-panel__toggle" id="theory-toggle">
        <span>ğŸ“– TÃ i liá»‡u ngá»¯ phÃ¡p</span>
        <span class="theory-panel__icon" id="theory-icon">â–¼</span>
      </button>

      <div class="theory-panel__content" id="theory-content">
        <div class="theory-panel__section">
          <h3 class="theory-panel__heading">ğŸ“Œ CÃ¢u Bá»‹ Äá»™ng lÃ  gÃ¬? (What is Passive Voice?)</h3>
          <p><strong>CÃ¢u Chá»§ Äá»™ng (Active):</strong> Chá»§ ngá»¯ thá»±c hiá»‡n hÃ nh Ä‘á»™ng</p>
          <p><strong>CÃ¢u Bá»‹ Äá»™ng (Passive):</strong> Chá»§ ngá»¯ chá»‹u tÃ¡c Ä‘á»™ng cá»§a hÃ nh Ä‘á»™ng</p>

          <div class="theory-panel__example">
            <strong>Active:</strong> They <strong>make</strong> films in London. <em>(Há» lÃ m phim á»Ÿ London)</em><br>
            â†’ Chá»§ ngá»¯ "They" thá»±c hiá»‡n hÃ nh Ä‘á»™ng "make"<br><br>
            <strong>Passive:</strong> Films <strong>are made</strong> in London. <em>(Phim Ä‘Æ°á»£c lÃ m á»Ÿ London)</em><br>
            â†’ Chá»§ ngá»¯ "Films" chá»‹u tÃ¡c Ä‘á»™ng cá»§a hÃ nh Ä‘á»™ng "make"
          </div>

          <p><strong>âœ¨ Khi nÃ o dÃ¹ng cÃ¢u bá»‹ Ä‘á»™ng?</strong></p>
          <ul>
            <li>ğŸ¤· KhÃ´ng biáº¿t ai lÃ m hÃ nh Ä‘á»™ng: <em>"My bike was stolen."</em></li>
            <li>ğŸ¯ KhÃ´ng quan trá»ng ai lÃ m: <em>"Rice is grown in Asia."</em></li>
            <li>ğŸ“¢ Muá»‘n nháº¥n máº¡nh vÃ o hÃ nh Ä‘á»™ng/váº­t: <em>"The Mona Lisa was painted in 1503."</em></li>
            <li>ğŸ“° VÄƒn phong trang trá»ng, khÃ¡ch quan: <em>"English is spoken worldwide."</em></li>
          </ul>
        </div>

        <div class="theory-panel__section">
          <h3 class="theory-panel__heading">ğŸ”§ Cáº¥u TrÃºc CÃ¢u Bá»‹ Äá»™ng ThÃ¬ Hiá»‡n Táº¡i ÄÆ¡n</h3>
          <p><strong>CÃ´ng thá»©c:</strong></p>
          <div class="theory-panel__example" style="background: #e3f2fd; padding: 15px; border-left: 4px solid #2196F3;">
            <strong style="font-size: 1.1em;">S + am/is/are + V3 (past participle)</strong>
          </div>

          <p style="margin-top: 15px;"><strong>ğŸ“– Chi tiáº¿t:</strong></p>
          <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
            <tr style="background: var(--bg-light);">
              <th style="padding: 10px; text-align: left;">Dáº¡ng cÃ¢u</th>
              <th style="padding: 10px; text-align: left;">Cáº¥u trÃºc</th>
              <th style="padding: 10px; text-align: left;">VÃ­ dá»¥</th>
            </tr>
            <tr>
              <td style="padding: 10px;"><strong>Kháº³ng Ä‘á»‹nh (+)</strong></td>
              <td style="padding: 10px;">S + am/is/are + V3</td>
              <td style="padding: 10px;">French <strong>is spoken</strong> here.<br><em>(Tiáº¿ng PhÃ¡p Ä‘Æ°á»£c nÃ³i á»Ÿ Ä‘Ã¢y)</em></td>
            </tr>
            <tr style="background: var(--bg-light);">
              <td style="padding: 10px;"><strong>Phá»§ Ä‘á»‹nh (-)</strong></td>
              <td style="padding: 10px;">S + am/is/are + not + V3</td>
              <td style="padding: 10px;">English <strong>isn't spoken</strong> here.<br><em>(Tiáº¿ng Anh khÃ´ng Ä‘Æ°á»£c nÃ³i á»Ÿ Ä‘Ã¢y)</em></td>
            </tr>
            <tr>
              <td style="padding: 10px;"><strong>Nghi váº¥n (?)</strong></td>
              <td style="padding: 10px;">Am/Is/Are + S + V3?</td>
              <td style="padding: 10px;"><strong>Is</strong> French <strong>spoken</strong> here?<br><em>(Tiáº¿ng PhÃ¡p cÃ³ Ä‘Æ°á»£c nÃ³i á»Ÿ Ä‘Ã¢y khÃ´ng?)</em></td>
            </tr>
          </table>

          <p style="margin-top: 15px;"><strong>ğŸ’¡ LÆ°u Ã½ quan trá»ng:</strong></p>
          <ul>
            <li><strong>Singular subject (chá»§ ngá»¯ sá»‘ Ã­t):</strong> is/isn't<br>
              <em>The film <strong>is</strong> made, Rice <strong>is</strong> grown</em>
            </li>
            <li><strong>Plural subject (chá»§ ngá»¯ sá»‘ nhiá»u):</strong> are/aren't<br>
              <em>Films <strong>are</strong> made, Books <strong>are</strong> sold</em>
            </li>
            <li><strong>Vá»›i I (tÃ´i):</strong> am/am not<br>
              <em>I <strong>am</strong> invited to the party</em>
            </li>
          </ul>
        </div>

        <div class="theory-panel__section">
          <h3 class="theory-panel__heading">ğŸ“š Past Participle (V3) - QuÃ¡ Khá»© PhÃ¢n Tá»«</h3>
          <p><strong>Äá»™ng tá»« cÃ³ quy táº¯c (Regular Verbs):</strong> ThÃªm <strong>-ed</strong> (giá»‘ng Past Simple V2)</p>
          <div class="theory-panel__example">
            use â†’ used â†’ <strong>used</strong><br>
            clean â†’ cleaned â†’ <strong>cleaned</strong><br>
            decorate â†’ decorated â†’ <strong>decorated</strong>
          </div>

          <p style="margin-top: 15px;"><strong>Äá»™ng tá»« báº¥t quy táº¯c (Irregular Verbs):</strong> Pháº£i há»c thuá»™c lÃ²ng</p>
          <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
            <tr style="background: var(--bg-light);">
              <th style="padding: 8px;">V1 (Base)</th>
              <th style="padding: 8px;">V2 (Past)</th>
              <th style="padding: 8px;">V3 (Past Participle)</th>
              <th style="padding: 8px;">NghÄ©a</th>
            </tr>
            <tr>
              <td style="padding: 8px;">speak</td>
              <td style="padding: 8px;">spoke</td>
              <td style="padding: 8px;"><strong>spoken</strong></td>
              <td style="padding: 8px;">nÃ³i</td>
            </tr>
            <tr style="background: var(--bg-light);">
              <td style="padding: 8px;">make</td>
              <td style="padding: 8px;">made</td>
              <td style="padding: 8px;"><strong>made</strong></td>
              <td style="padding: 8px;">lÃ m, cháº¿ táº¡o</td>
            </tr>
            <tr>
              <td style="padding: 8px;">write</td>
              <td style="padding: 8px;">wrote</td>
              <td style="padding: 8px;"><strong>written</strong></td>
              <td style="padding: 8px;">viáº¿t</td>
            </tr>
            <tr style="background: var(--bg-light);">
              <td style="padding: 8px;">build</td>
              <td style="padding: 8px;">built</td>
              <td style="padding: 8px;"><strong>built</strong></td>
              <td style="padding: 8px;">xÃ¢y dá»±ng</td>
            </tr>
            <tr>
              <td style="padding: 8px;">sell</td>
              <td style="padding: 8px;">sold</td>
              <td style="padding: 8px;"><strong>sold</strong></td>
              <td style="padding: 8px;">bÃ¡n</td>
            </tr>
            <tr style="background: var(--bg-light);">
              <td style="padding: 8px;">teach</td>
              <td style="padding: 8px;">taught</td>
              <td style="padding: 8px;"><strong>taught</strong></td>
              <td style="padding: 8px;">dáº¡y</td>
            </tr>
            <tr>
              <td style="padding: 8px;">grow</td>
              <td style="padding: 8px;">grew</td>
              <td style="padding: 8px;"><strong>grown</strong></td>
              <td style="padding: 8px;">trá»“ng, phÃ¡t triá»ƒn</td>
            </tr>
          </table>
        </div>

        <div class="theory-panel__section">
          <h3 class="theory-panel__heading">ğŸ”„ CÃ¡ch Chuyá»ƒn Tá»« Active Sang Passive</h3>
          <p><strong>CÃ¡c bÆ°á»›c thá»±c hiá»‡n:</strong></p>
          <ol style="line-height: 1.8;">
            <li><strong>BÆ°á»›c 1:</strong> TÃ¢n ngá»¯ (Object) trong cÃ¢u chá»§ Ä‘á»™ng â†’ Chá»§ ngá»¯ (Subject) trong cÃ¢u bá»‹ Ä‘á»™ng</li>
            <li><strong>BÆ°á»›c 2:</strong> Äá»™ng tá»« â†’ am/is/are + V3</li>
            <li><strong>BÆ°á»›c 3:</strong> Chá»§ ngá»¯ cÅ© â†’ by + agent (cÃ³ thá»ƒ bá» náº¿u khÃ´ng quan trá»ng)</li>
          </ol>

          <div class="theory-panel__example" style="margin-top: 10px;">
            <strong>VÃ­ dá»¥:</strong><br>
            <strong>Active:</strong> People speak French in Canada.<br>
            <span style="color: #666;">â†“ Chuyá»ƒn Ä‘á»•i â†“</span><br>
            <strong>Passive:</strong> French is spoken in Canada (by people).<br><br>

            <strong>Active:</strong> They make films in Hollywood.<br>
            <span style="color: #666;">â†“ Chuyá»ƒn Ä‘á»•i â†“</span><br>
            <strong>Passive:</strong> Films are made in Hollywood (by them).
          </div>
        </div>

        <div class="theory-panel__section">
          <h3 class="theory-panel__heading">ğŸ¯ BY vs WITH - PhÃ¢n Biá»‡t RÃµ RÃ ng</h3>

          <div style="background: #fff3e0; padding: 15px; border-left: 4px solid #ff9800; margin-bottom: 15px;">
            <p><strong>BY</strong> = Ai lÃ m hÃ nh Ä‘á»™ng (ngÆ°á»i/tÃ¡c nhÃ¢n)</p>
            <p style="color: #666; font-style: italic;">DÃ¹ng Ä‘á»ƒ chá»‰ ngÆ°á»i hoáº·c tÃ¡c nhÃ¢n thá»±c hiá»‡n hÃ nh Ä‘á»™ng</p>
            <div class="theory-panel__example">
              âœ“ The film is directed <strong>by Spielberg</strong>. <em>(Phim Ä‘Æ°á»£c Ä‘áº¡o diá»…n bá»Ÿi Spielberg)</em><br>
              âœ“ The food is brought <strong>by a waiter</strong>. <em>(Äá»“ Äƒn Ä‘Æ°á»£c mang Ä‘áº¿n bá»Ÿi nhÃ¢n viÃªn phá»¥c vá»¥)</em><br>
              âœ“ This book was written <strong>by J.K. Rowling</strong>. <em>(Cuá»‘n sÃ¡ch Ä‘Æ°á»£c viáº¿t bá»Ÿi J.K. Rowling)</em>
            </div>
          </div>

          <div style="background: #e8f5e9; padding: 15px; border-left: 4px solid #4CAF50; margin-bottom: 15px;">
            <p><strong>WITH</strong> = DÃ¹ng cÃ´ng cá»¥/váº­t liá»‡u/nguyÃªn liá»‡u gÃ¬</p>
            <p style="color: #666; font-style: italic;">DÃ¹ng Ä‘á»ƒ chá»‰ cÃ´ng cá»¥, váº­t liá»‡u, hoáº·c thá»© dÃ¹ng Ä‘á»ƒ thá»±c hiá»‡n hÃ nh Ä‘á»™ng</p>
            <div class="theory-panel__example">
              âœ“ Bread is cut <strong>with a knife</strong>. <em>(BÃ¡nh mÃ¬ Ä‘Æ°á»£c cáº¯t báº±ng dao)</em><br>
              âœ“ The streets are decorated <strong>with lights</strong>. <em>(ÄÆ°á»ng phá»‘ Ä‘Æ°á»£c trang trÃ­ báº±ng Ä‘Ã¨n)</em><br>
              âœ“ The picture is painted <strong>with oil paints</strong>. <em>(Bá»©c tranh Ä‘Æ°á»£c váº½ báº±ng sÆ¡n dáº§u)</em><br>
              âœ“ The room is filled <strong>with flowers</strong>. <em>(PhÃ²ng Ä‘Æ°á»£c láº¥p Ä‘áº§y báº±ng hoa)</em>
            </div>
          </div>

          <p><strong>ğŸ’¡ Káº¿t há»£p cáº£ BY vÃ  WITH:</strong></p>
          <div class="theory-panel__example">
            The picture was painted <strong>by Picasso</strong> <strong>with oil paints</strong>.<br>
            <em>(Bá»©c tranh Ä‘Æ°á»£c váº½ bá»Ÿi Picasso báº±ng sÆ¡n dáº§u)</em><br>
            â†’ <strong>by</strong> + ngÆ°á»i lÃ m, <strong>with</strong> + cÃ´ng cá»¥
          </div>

          <p style="margin-top: 15px;"><strong>âš ï¸ Lá»—i thÆ°á»ng gáº·p:</strong></p>
          <ul>
            <li>âŒ The food is brought <strong>with</strong> a waiter. â†’ âœ“ ... <strong>by</strong> a waiter</li>
            <li>âŒ Bread is cut <strong>by</strong> a knife. â†’ âœ“ ... <strong>with</strong> a knife</li>
          </ul>
        </div>

        <div class="theory-panel__section">
          <h3 class="theory-panel__heading">âš ï¸ Lá»—i Sai ThÆ°á»ng Gáº·p vÃ  CÃ¡ch Sá»­a</h3>
          <table style="width: 100%; border-collapse: collapse;">
            <tr style="background: #ffebee;">
              <th style="padding: 10px; width: 50%;">âŒ SAI</th>
              <th style="padding: 10px; width: 50%;">âœ“ ÄÃšNG</th>
            </tr>
            <tr>
              <td style="padding: 10px;">The film is <strong>make</strong> in London.</td>
              <td style="padding: 10px;">The film is <strong>made</strong> in London.<br><em>(DÃ¹ng V3, khÃ´ng dÃ¹ng V1)</em></td>
            </tr>
            <tr style="background: var(--bg-light);">
              <td style="padding: 10px;">French is <strong>spoke</strong> here.</td>
              <td style="padding: 10px;">French is <strong>spoken</strong> here.<br><em>(V3 cá»§a speak lÃ  spoken)</em></td>
            </tr>
            <tr>
              <td style="padding: 10px;">Books <strong>is</strong> sold here.</td>
              <td style="padding: 10px;">Books <strong>are</strong> sold here.<br><em>(Sá»‘ nhiá»u dÃ¹ng are)</em></td>
            </tr>
            <tr style="background: var(--bg-light);">
              <td style="padding: 10px;">Rice is <strong>grew</strong> in Asia.</td>
              <td style="padding: 10px;">Rice is <strong>grown</strong> in Asia.<br><em>(V3 cá»§a grow lÃ  grown)</em></td>
            </tr>
            <tr>
              <td style="padding: 10px;">The house is built <strong>by</strong> bricks.</td>
              <td style="padding: 10px;">The house is built <strong>with</strong> bricks.<br><em>(Váº­t liá»‡u dÃ¹ng with)</em></td>
            </tr>
          </table>
        </div>

        <div class="theory-panel__section">
          <h3 class="theory-panel__heading">ğŸ’ª Máº¹o Há»c Hiá»‡u Quáº£</h3>
          <ol style="line-height: 1.8;">
            <li><strong>Há»c thuá»™c V3 cá»§a Ä‘á»™ng tá»« báº¥t quy táº¯c:</strong> LÃ m flashcard, viáº¿t nhiá»u láº§n</li>
            <li><strong>Nhá»› cÃ´ng thá»©c:</strong> am/is/are + V3 (khÃ´ng pháº£i V1 hay V2!)</li>
            <li><strong>BY vs WITH:</strong> BY = ngÆ°á»i/tÃ¡c nhÃ¢n, WITH = cÃ´ng cá»¥/váº­t liá»‡u</li>
            <li><strong>Luyá»‡n chuyá»ƒn Ä‘á»•i:</strong> Viáº¿t cÃ¢u Active rá»“i chuyá»ƒn sang Passive</li>
            <li><strong>Äá»c vÃ­ dá»¥ thá»±c táº¿:</strong> ChÃº Ã½ cÃ¢u bá»‹ Ä‘á»™ng trong sÃ¡ch bÃ¡o, bÃ i Ä‘á»c</li>
          </ol>
        </div>
      </div>
    </div>

    <!-- Exercise Container -->
    <div id="exercise-container">
      <!-- Exercises will be rendered here dynamically -->
      <div class="card text-center">
        <h2>Loading...</h2>
        <p>Please wait while we load the exercises.</p>
      </div>
    </div>
  </main>

  <!-- Core JavaScript (loaded first) -->
  <script src="../js/core/utils.js"></script>
  <script src="../js/core/storage.js"></script>
  <script src="../js/core/telegram-sender.js"></script>
  <script src="../js/core/game-engine.js"></script>

  <!-- Exercise Type Handlers -->
  <script src="../js/exercises/multiple-choice.js"></script>
  <script src="../js/exercises/word-rearrange.js"></script>
  <script src="../js/exercises/fill-blank.js"></script>
  <script src="../js/exercises/fill-blank-table.js"></script>
  <script src="../js/exercises/sentence-build.js"></script>
  <script src="../js/exercises/sentence-rewrite.js"></script>
  <script src="../js/exercises/error-correct.js"></script>
  <script src="../js/exercises/translation.js"></script>
  <script src="../js/exercises/open-ended.js"></script>

  <!-- Initialize Game -->
  <script>
    const UNIT_ID = 'unit-11-making-a-film';
    const DATA_PATH = '../data/unit-11-making-a-film.json';

    // Theory panel toggle
    const theoryToggle = document.getElementById('theory-toggle');
    const theoryContent = document.getElementById('theory-content');
    const theoryIcon = document.getElementById('theory-icon');

    theoryToggle.addEventListener('click', () => {
      const isExpanded = theoryContent.classList.contains('theory-panel__content--expanded');

      if (isExpanded) {
        theoryContent.classList.remove('theory-panel__content--expanded');
        theoryIcon.classList.remove('theory-panel__icon--rotated');
      } else {
        theoryContent.classList.add('theory-panel__content--expanded');
        theoryIcon.classList.add('theory-panel__icon--rotated');
      }
    });

    // Combo display logic
    function updateComboDisplay() {
      const comboDisplay = document.getElementById('combo-display');
      const comboCount = document.getElementById('combo-count');
      const state = GameEngine.getState();

      if (state.comboCount >= 3) {
        comboDisplay.style.display = 'flex';
        comboCount.textContent = state.comboCount + 'x ğŸ”¥';
      } else {
        comboDisplay.style.display = 'none';
      }
    }

    // Override GameEngine.updateUI to include combo display
    const originalUpdateUI = GameEngine.updateUI.bind(GameEngine);
    GameEngine.updateUI = function() {
      originalUpdateUI();
      updateComboDisplay();
    };

    // Load unit data and start game
    async function loadAndStartGame() {
      try {
        const response = await fetch(DATA_PATH);

        if (!response.ok) {
          throw new Error(`Failed to load data: ${response.status}`);
        }

        const unitData = await response.json();

        console.log('Unit data loaded:', unitData);
        console.log('Registered exercise handlers:', Object.keys(GameEngine.exerciseHandlers));

        GameEngine.init(unitData, UNIT_ID);

      } catch (error) {
        console.error('Error loading game data:', error);

        const container = document.getElementById('exercise-container');
        container.innerHTML = `
          <div class="card">
            <h2 style="color: var(--danger);">Error Loading Game</h2>
            <p>Sorry, we couldn't load the exercise data. Please try refreshing the page.</p>
            <p style="font-size: var(--font-size-sm); color: var(--text-light);">Error: ${error.message}</p>
            <button class="btn btn--primary mt-2" onclick="location.reload()">Reload Page</button>
          </div>
        `;
      }
    }

    // Start game when page loads
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', loadAndStartGame);
    } else {
      loadAndStartGame();
    }
  </script>
</body>
</html>
