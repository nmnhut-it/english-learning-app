<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>√în Thi L·ªõp 10 - Speaking & Daily Conversations | English Practice</title>
  <meta name="description" content="Luy·ªán t·∫≠p giao ti·∫øp ti·∫øng Anh thi v√†o l·ªõp 10 - Communicative Exchanges">

  <!-- Shared Styles -->
  <link rel="stylesheet" href="../css/shared.css">
</head>
<body>
  <!-- Game Header -->
  <header class="game-header">
    <div class="container">
      <div class="game-header__container">
        <div class="game-header__info-section">
          <h1 class="game-header__title">√în Thi V√†o L·ªõp 10</h1>
          <p class="game-header__subtitle">Speaking & Daily Conversations</p>

          <div class="game-info">
            <div class="game-info__item">
              <span class="game-info__label">Gi√°o vi√™n:</span>
              <span class="game-info__value">Nguy·ªÖn Minh Nh·ª±t</span>
            </div>
            <div class="game-info__item">
              <span class="game-info__label">NƒÉm h·ªçc:</span>
              <span class="game-info__value">2024-2025</span>
            </div>
          </div>
        </div>

        <div class="game-header__stats">
          <div class="stat">
            <span class="stat__label">ƒêi·ªÉm</span>
            <span class="stat__value stat__value--primary" id="current-score">0</span>
          </div>

          <div class="stat">
            <span class="stat__label">Ti·∫øn ƒë·ªô</span>
            <span class="stat__value" id="progress-count">0 / 0</span>
          </div>

          <div class="stat" id="combo-display" style="display: none;">
            <span class="stat__label">Combo</span>
            <span class="stat__value" id="combo-count">0</span>
          </div>
        </div>
      </div>

      <!-- Progress Bar -->
      <div class="progress">
        <div class="progress__bar" id="progress-bar" style="width: 0%;"></div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="container">
    <!-- Theory Panel (Collapsible) -->
    <div class="theory-panel" id="theory-panel">
      <button class="theory-panel__toggle" id="theory-toggle">
        <span>üìñ L√Ω thuy·∫øt giao ti·∫øp (Communicative Exchanges)</span>
        <span class="theory-panel__icon" id="theory-icon">‚ñº</span>
      </button>

      <div class="theory-panel__content" id="theory-content">
        <!-- Section 1: Invitations -->
        <div class="theory-panel__section">
          <h3 class="theory-panel__heading">1. L·ªùi m·ªùi v√† c√°ch ƒë√°p l·∫°i (Invitations)</h3>

          <div class="theory-panel__example">
            <strong>C√°ch m·ªùi:</strong><br>
            ‚Ä¢ Would you like + N/to V? (B·∫°n c√≥ mu·ªën...?)<br>
            ‚Ä¢ Would you care to join us? (B·∫°n mu·ªën tham gia c√πng kh√¥ng?)<br>
            ‚Ä¢ Do you want to go out with me tonight? (B·∫°n c√≥ mu·ªën ƒëi ch∆°i t·ªëi nay kh√¥ng?)<br>
            ‚Ä¢ Do you feel like going for a walk? (B·∫°n c√≥ mu·ªën ƒëi d·∫°o kh√¥ng?)<br><br>

            <strong style="color: var(--success);">ƒê·ªìng √Ω:</strong><br>
            ‚Ä¢ Yes, please. / I'd love to, thanks.<br>
            ‚Ä¢ That's very kind of you, thanks.<br>
            ‚Ä¢ That sounds lovely, thanks.<br>
            ‚Ä¢ With pleasure! / Sure. / Sounds good.<br><br>

            <strong style="color: var(--danger);">T·ª´ ch·ªëi:</strong><br>
            ‚Ä¢ I'm sorry to refuse your invitation.<br>
            ‚Ä¢ I can't, sorry. I have to work.<br>
            ‚Ä¢ I'm afraid I won't be able to come.<br>
            ‚Ä¢ Sorry, I'd love to but I have an appointment.
          </div>
        </div>

        <!-- Section 2: Requests & Permission -->
        <div class="theory-panel__section">
          <h3 class="theory-panel__heading">2. L·ªùi y√™u c·∫ßu, ƒë·ªÅ ngh·ªã (Requests & Permission)</h3>

          <h4 style="margin-top: 1rem; color: var(--primary);">2.1. H·ªèi xin ph√©p:</h4>
          <div class="theory-panel__example">
            <strong>C√°ch h·ªèi:</strong><br>
            ‚Ä¢ Can I...? / Could I...? (T√¥i c√≥ th·ªÉ... kh√¥ng?)<br>
            ‚Ä¢ Is it OK if I...? (C√≥ ƒë∆∞·ª£c kh√¥ng n·∫øu t√¥i...?)<br>
            ‚Ä¢ Do you mind if I...? (B·∫°n c√≥ phi·ªÅn kh√¥ng n·∫øu t√¥i...?)<br><br>

            <strong style="color: var(--success);">ƒê·ªìng √Ω:</strong><br>
            ‚Ä¢ Yes, sure. / Yes, of course. / Certainly.<br>
            ‚Ä¢ <strong>V·ªõi "Do you mind...?":</strong> No, not at all. / No, of course not.<br><br>

            <strong style="color: var(--danger);">T·ª´ ch·ªëi:</strong><br>
            ‚Ä¢ Well, I'm afraid... (+ l√Ω do)<br>
            ‚Ä¢ I'd rather you didn't.<br>
            ‚Ä¢ Sorry, but...
          </div>

          <div style="background: #fff3cd; padding: 0.8rem; margin-top: 1rem; border-radius: 4px;">
            <strong>L∆∞u √Ω quan tr·ªçng:</strong> V·ªõi c√¢u h·ªèi "Do you mind if...?" ho·∫∑c "Would you mind if...?":<br>
            ‚Ä¢ Tr·∫£ l·ªùi <strong>"No"</strong> = ƒê·ªìng √Ω (Kh√¥ng, t√¥i kh√¥ng phi·ªÅn)<br>
            ‚Ä¢ Tr·∫£ l·ªùi <strong>"Yes"</strong> = T·ª´ ch·ªëi (C√≥, t√¥i phi·ªÅn)
          </div>

          <h4 style="margin-top: 1rem; color: var(--primary);">2.2. ƒê·ªÅ ngh·ªã ai ƒë√≥ l√†m g√¨:</h4>
          <div class="theory-panel__example">
            <strong>C√°ch ƒë·ªÅ ngh·ªã:</strong><br>
            ‚Ä¢ Can you help me...? / Could you...?<br>
            ‚Ä¢ Will you help me...? / Would you...?<br>
            ‚Ä¢ Do you mind + V-ing? / Would you mind + V-ing?<br><br>

            <strong style="color: var(--success);">ƒê·ªìng √Ω:</strong><br>
            ‚Ä¢ Yes, sure. / Yes, of course. / Certainly.<br>
            ‚Ä¢ <strong>V·ªõi "mind":</strong> No, not at all. / Of course not.<br><br>

            <strong style="color: var(--danger);">T·ª´ ch·ªëi:</strong><br>
            ‚Ä¢ Well, I'm afraid... / Sorry, but...
          </div>
        </div>

        <!-- Section 3: Suggestions -->
        <div class="theory-panel__section">
          <h3 class="theory-panel__heading">3. L·ªùi g·ª£i √Ω (Suggestions)</h3>

          <div class="theory-panel__example">
            <strong>C√°ch g·ª£i √Ω:</strong><br>
            ‚Ä¢ Let's + V (H√£y c√πng...)<br>
            ‚Ä¢ What about + V-ing? / How about + V-ing? (Th·∫ø c√≤n... th√¨ sao?)<br>
            ‚Ä¢ Why don't we + V? (Sao ch√∫ng ta kh√¥ng...?)<br>
            ‚Ä¢ Shall we + V? (Ch√∫ng ta... nh√©?)<br>
            ‚Ä¢ Couldn't we + V? (Ch√∫ng ta c√≥ th·ªÉ... kh√¥ng?)<br><br>

            <strong style="color: var(--success);">ƒê·ªìng √Ω:</strong><br>
            ‚Ä¢ Yes, I'd love to. / Yes, I'd like to.<br>
            ‚Ä¢ What a good idea! / Why not?<br>
            ‚Ä¢ Yes, that sounds like a great idea.<br>
            ‚Ä¢ Yes, let's. / Sounds good to me.<br>
            ‚Ä¢ Count me in too. / I'm up for it.<br><br>

            <strong style="color: var(--danger);">T·ª´ ch·ªëi:</strong><br>
            ‚Ä¢ No, let's not. / No, thanks.<br>
            ‚Ä¢ Well, I'd rather/prefer...<br>
            ‚Ä¢ I don't feel like it.<br>
            ‚Ä¢ I don't think that's a good idea.
          </div>

          <div style="background: #d1ecf1; padding: 0.8rem; margin-top: 1rem; border-radius: 4px;">
            <strong>L∆∞u √Ω:</strong> "Why don't we...?" l√† c√¢u G·ª¢I √ù, kh√¥ng ph·∫£i h·ªèi l√Ω do.<br>
            Kh√¥ng tr·∫£ l·ªùi "Because..." m√† tr·∫£ l·ªùi ƒë·ªìng √Ω/t·ª´ ch·ªëi.
          </div>
        </div>

        <!-- Section 4: Apologies -->
        <div class="theory-panel__section">
          <h3 class="theory-panel__heading">4. L·ªùi xin l·ªói (Apologies)</h3>

          <div class="theory-panel__example">
            <strong>C√°ch xin l·ªói:</strong><br>
            ‚Ä¢ Sorry, I'm late. / I'm sorry for...<br>
            ‚Ä¢ I apologize for...<br><br>

            <strong style="color: var(--success);">Ch·∫•p nh·∫≠n l·ªùi xin l·ªói:</strong><br>
            ‚Ä¢ It doesn't matter. (Kh√¥ng c√≥ g√¨ quan tr·ªçng ƒë√¢u)<br>
            ‚Ä¢ Don't apologize. (Kh√¥ng c·∫ßn xin l·ªói ƒë√¢u)<br>
            ‚Ä¢ That's all right. / It's alright. / It's okay.<br>
            ‚Ä¢ Never mind. (ƒê·ª´ng b·∫≠n t√¢m)<br>
            ‚Ä¢ No worries. (ƒê·ª´ng lo)<br>
            ‚Ä¢ I quite understand. (T√¥i hi·ªÉu m√†)
          </div>
        </div>

        <!-- Section 5: Thanks -->
        <div class="theory-panel__section">
          <h3 class="theory-panel__heading">5. L·ªùi c·∫£m ∆°n (Thanks)</h3>

          <div class="theory-panel__example">
            <strong>C√°ch c·∫£m ∆°n:</strong><br>
            ‚Ä¢ Thank you for helping me. / Thanks a lot.<br>
            ‚Ä¢ It was very kind of you to...<br><br>

            <strong style="color: var(--success);">ƒê√°p l·∫°i l·ªùi c·∫£m ∆°n:</strong><br>
            ‚Ä¢ That's all right! / You're welcome.<br>
            ‚Ä¢ Don't mention it. / Not at all.<br>
            ‚Ä¢ It's nothing. / My pleasure.<br>
            ‚Ä¢ It's my pleasure. (ƒê√≥ l√† ni·ªÅm vui c·ªßa t√¥i)
          </div>
        </div>

        <!-- Section 6: Opinions -->
        <div class="theory-panel__section">
          <h3 class="theory-panel__heading">6. ƒê∆∞a √Ω ki·∫øn (Opinions)</h3>

          <div class="theory-panel__example">
            <strong>C√°ch ƒë∆∞a √Ω ki·∫øn:</strong><br>
            ‚Ä¢ I think... / In my opinion...<br>
            ‚Ä¢ Personally, I...<br><br>

            <strong style="color: var(--success);">ƒê·ªìng √Ω ho√†n to√†n:</strong><br>
            ‚Ä¢ I completely/absolutely agree with you.<br>
            ‚Ä¢ I couldn't agree more. (T√¥i kh√¥ng th·ªÉ ƒë·ªìng √Ω h∆°n ƒë∆∞·ª£c n·ªØa)<br>
            ‚Ä¢ Exactly. / Absolutely. / Of course.<br>
            ‚Ä¢ That's so true. / You're absolutely right.<br>
            ‚Ä¢ So do I. / Neither do I. (t√πy c√¢u kh·∫≥ng ƒë·ªãnh/ph·ªß ƒë·ªãnh)<br><br>

            <strong style="color: #ff9800;">ƒê·ªìng √Ω m·ªôt ph·∫ßn:</strong><br>
            ‚Ä¢ I agree up to a point, but...<br>
            ‚Ä¢ That's true, but... / You could be right.<br>
            ‚Ä¢ I see your point, but...<br><br>

            <strong style="color: var(--danger);">Ph·∫£n ƒë·ªëi:</strong><br>
            ‚Ä¢ I totally disagree. / I don't think so!<br>
            ‚Ä¢ I'm afraid I can't agree with you.<br>
            ‚Ä¢ I'm sorry, but I disagree.
          </div>

          <div style="background: #fff3cd; padding: 0.8rem; margin-top: 1rem; border-radius: 4px;">
            <strong>Quy t·∫Øc So do I / Neither do I:</strong><br>
            ‚Ä¢ C√¢u KH·∫≤NG ƒê·ªäNH: "I love coffee." ‚Üí "So do I." (T√¥i c≈©ng v·∫≠y)<br>
            ‚Ä¢ C√¢u PH·ª¶ ƒê·ªäNH: "I don't like tea." ‚Üí "Neither do I." (T√¥i c≈©ng kh√¥ng)
          </div>
        </div>

        <!-- Section 7: Other Situations -->
        <div class="theory-panel__section">
          <h3 class="theory-panel__heading">7. M·ªôt s·ªë t√¨nh hu·ªëng kh√°c</h3>

          <div class="theory-panel__example">
            <table style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
              <tr style="background: var(--primary); color: white;">
                <th style="padding: 0.5rem; border: 1px solid #ddd;">T√¨nh hu·ªëng</th>
                <th style="padding: 0.5rem; border: 1px solid #ddd;">C√°ch ƒë√°p l·∫°i</th>
              </tr>
              <tr>
                <td style="padding: 0.5rem; border: 1px solid #ddd;"><strong>G·∫∑p l·∫ßn ƒë·∫ßu:</strong><br>Nice to meet you!</td>
                <td style="padding: 0.5rem; border: 1px solid #ddd;">Nice to meet you, too.<br>How do you do?</td>
              </tr>
              <tr style="background: #f5f5f5;">
                <td style="padding: 0.5rem; border: 1px solid #ddd;"><strong>H·ªèi thƒÉm:</strong><br>How are you?</td>
                <td style="padding: 0.5rem; border: 1px solid #ddd;">I'm fine, thanks. And you?<br>Pretty good. / Can't complain.</td>
              </tr>
              <tr>
                <td style="padding: 0.5rem; border: 1px solid #ddd;"><strong>L·ªùi ch√∫c:</strong><br>Have a nice day!</td>
                <td style="padding: 0.5rem; border: 1px solid #ddd;">You too!<br>The same to you!</td>
              </tr>
              <tr style="background: #f5f5f5;">
                <td style="padding: 0.5rem; border: 1px solid #ddd;"><strong>ƒê∆∞·ª£c khen:</strong><br>What a nice dress!</td>
                <td style="padding: 0.5rem; border: 1px solid #ddd;">Thank you.<br>I'm glad you like it.</td>
              </tr>
              <tr>
                <td style="padding: 0.5rem; border: 1px solid #ddd;"><strong>Tin vui:</strong><br>I've passed my exam!</td>
                <td style="padding: 0.5rem; border: 1px solid #ddd;">Congratulations!<br>That's great!</td>
              </tr>
              <tr style="background: #f5f5f5;">
                <td style="padding: 0.5rem; border: 1px solid #ddd;"><strong>Tr∆∞·ªõc k·ª≥ thi:</strong><br>I'm taking my exam tomorrow.</td>
                <td style="padding: 0.5rem; border: 1px solid #ddd;">Good luck!<br>Best of luck!</td>
              </tr>
              <tr>
                <td style="padding: 0.5rem; border: 1px solid #ddd;"><strong>Tin bu·ªìn/Th·∫•t b·∫°i:</strong><br>I failed my test.</td>
                <td style="padding: 0.5rem; border: 1px solid #ddd;">Never mind. Better luck next time!<br>I'm sorry to hear that.</td>
              </tr>
              <tr style="background: #f5f5f5;">
                <td style="padding: 0.5rem; border: 1px solid #ddd;"><strong>ƒê∆∞a ƒë·ªì v·∫≠t:</strong><br>Could you pass me the salt?</td>
                <td style="padding: 0.5rem; border: 1px solid #ddd;">Here you are!</td>
              </tr>
            </table>
          </div>
        </div>

        <!-- Common Mistakes -->
        <div class="theory-panel__section">
          <h3 class="theory-panel__heading">L·ªói th∆∞·ªùng g·∫∑p</h3>

          <div class="theory-panel__example">
            <strong>1. Nh·∫ßm "So do I" v·ªõi "Neither do I":</strong><br>
            ‚Ä¢ "I like coffee." ‚Üí "So do I." (T√¥i c≈©ng v·∫≠y)<br>
            ‚Ä¢ "I don't like coffee." ‚Üí "Neither do I." (T√¥i c≈©ng kh√¥ng)<br><br>

            <strong>2. Nh·∫ßm "Do you mind...?" v·ªõi c√°c c√¢u h·ªèi th√¥ng th∆∞·ªùng:</strong><br>
            ‚Ä¢ "Do you mind if I smoke?" ‚Üí "No, not at all." (= ƒê·ªìng √Ω)<br>
            ‚Ä¢ "Can I smoke here?" ‚Üí "Yes, you can." (= ƒê·ªìng √Ω)<br><br>

            <strong>3. Nh·∫ßm "Good luck!" v·ªõi "Congratulations!":</strong><br>
            ‚Ä¢ TR∆Ø·ªöC s·ª± ki·ªán: "Good luck!" (Ch√∫c may m·∫Øn!)<br>
            ‚Ä¢ SAU th√†nh c√¥ng: "Congratulations!" (Ch√∫c m·ª´ng!)<br><br>

            <strong>4. ƒê√°p l·∫°i "Why don't we...?" sai:</strong><br>
            ‚Ä¢ "Why don't we go to the beach?" (G·ª£i √Ω)<br>
            ‚Ä¢ ‚ùå "Because I like the beach."<br>
            ‚Ä¢ ‚úì "That's a great idea!" / "Sounds good!"
          </div>
        </div>
      </div>
    </div>

    <!-- Exercise Container -->
    <div id="exercise-container">
      <!-- Exercises will be rendered here dynamically -->
      <div class="card text-center">
        <h2>ƒêang t·∫£i...</h2>
        <p>Vui l√≤ng ƒë·ª£i trong khi ch√∫ng t√¥i t·∫£i b√†i t·∫≠p.</p>
      </div>
    </div>
  </main>

  <!-- Core JavaScript (loaded first) -->
  <script src="../js/core/utils.js"></script>
  <script src="../js/core/storage.js"></script>
  <script src="../js/core/telegram-sender.js"></script>
  <script src="../js/core/game-engine.js"></script>

  <!-- Exercise Type Handlers -->
  <script src="../js/exercises/multiple-choice.js"></script>

  <!-- Initialize Game -->
  <script>
    const UNIT_ID = 'on-thi-10-speaking';
    const DATA_PATH = '../data/on-thi-10-speaking.json';

    // Theory panel toggle
    const theoryToggle = document.getElementById('theory-toggle');
    const theoryContent = document.getElementById('theory-content');
    const theoryIcon = document.getElementById('theory-icon');

    theoryToggle.addEventListener('click', () => {
      const isExpanded = theoryContent.classList.contains('theory-panel__content--expanded');

      if (isExpanded) {
        theoryContent.classList.remove('theory-panel__content--expanded');
        theoryIcon.classList.remove('theory-panel__icon--rotated');
      } else {
        theoryContent.classList.add('theory-panel__content--expanded');
        theoryIcon.classList.add('theory-panel__icon--rotated');
      }
    });

    // Combo display logic
    function updateComboDisplay() {
      const comboDisplay = document.getElementById('combo-display');
      const comboCount = document.getElementById('combo-count');
      const state = GameEngine.getState();

      if (state.comboCount >= 3) {
        comboDisplay.style.display = 'flex';
        comboCount.textContent = state.comboCount + 'x';
      } else {
        comboDisplay.style.display = 'none';
      }
    }

    // Override GameEngine.updateUI to include combo display
    const originalUpdateUI = GameEngine.updateUI.bind(GameEngine);
    GameEngine.updateUI = function() {
      originalUpdateUI();
      updateComboDisplay();
    };

    // Load unit data and start game
    async function loadAndStartGame() {
      try {
        const response = await fetch(DATA_PATH);

        if (!response.ok) {
          throw new Error(`Failed to load data: ${response.status}`);
        }

        const unitData = await response.json();

        console.log('Unit data loaded:', unitData);
        console.log('Registered exercise handlers:', Object.keys(GameEngine.exerciseHandlers));

        GameEngine.init(unitData, UNIT_ID);

      } catch (error) {
        console.error('Error loading game data:', error);

        const container = document.getElementById('exercise-container');
        container.innerHTML = `
          <div class="card">
            <h2 style="color: var(--danger);">L·ªói t·∫£i b√†i t·∫≠p</h2>
            <p>Xin l·ªói, ch√∫ng t√¥i kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu b√†i t·∫≠p. Vui l√≤ng th·ª≠ t·∫£i l·∫°i trang.</p>
            <p style="font-size: var(--font-size-sm); color: var(--text-light);">L·ªói: ${error.message}</p>
            <button class="btn btn--primary mt-2" onclick="location.reload()">T·∫£i l·∫°i trang</button>
          </div>
        `;
      }
    }

    // Start game when page loads
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', loadAndStartGame);
    } else {
      loadAndStartGame();
    }
  </script>
</body>
</html>
